
==========================================================================================
RF-CPSS TEST: Paper-conform implementation with Random Forest
==========================================================================================

Changes from old implementation:
  1. q is FIXED (not adaptive)
  2. RF selects exactly q features on each subsample
  3. Permutation importance + feature-type weighting
  4. NO invalid unimodality tests
  5. Only worst-case bound (always valid)
==========================================================================================
DRUG: Erlotinib (RF-CPSS, paper-conform)
==========================================================================================

Expected biomarkers (7):
  - MUT__EGFR: EGFR mutations (primary target)
  - CNV__EGFR: EGFR amplification
  - TPM__EGFR: EGFR expression
  - MUT__KRAS: KRAS resistance
  - MUT__BRAF: BRAF resistance
  - TPM__MET: MET bypass
  - CNV__MET: MET amplification

Data: n=821, d=489, l=24, q=96

Running paper-conform RF-CPSS with B=60 pairs...
Running CPSS with B=60 pairs, target q=96, method=rf
  Pair 1/60... A1:96 A2:96
  Pair 2/60... A1:96 A2:96
  Pair 3/60... A1:96 A2:96
  Pair 4/60... A1:96 A2:96
  Pair 5/60... A1:96 A2:96
  Pair 6/60... A1:96 A2:96
  Pair 7/60... A1:96 A2:96
  Pair 8/60... A1:96 A2:96
  Pair 9/60... A1:96 A2:96
  Pair 10/60... A1:96 A2:96
  Pair 11/60... A1:96 A2:96
  Pair 12/60... A1:96 A2:96
  Pair 13/60... A1:96 A2:96
  Pair 14/60... A1:96 A2:96
  Pair 15/60... A1:96 A2:96
  Pair 16/60... A1:96 A2:96
  Pair 17/60... A1:96 A2:96
  Pair 18/60... A1:96 A2:96
  Pair 19/60... A1:96 A2:96
  Pair 20/60... A1:96 A2:96
  Pair 21/60... A1:96 A2:96
  Pair 22/60... A1:96 A2:96
  Pair 23/60... A1:96 A2:96
  Pair 24/60... A1:96 A2:96
  Pair 25/60... A1:96 A2:96
  Pair 26/60... A1:96 A2:96
  Pair 27/60... A1:96 A2:96
  Pair 28/60... A1:96 A2:96
  Pair 29/60... A1:96 A2:96
  Pair 30/60... A1:96 A2:96
  Pair 31/60... A1:96 A2:96
  Pair 32/60... A1:96 A2:96
  Pair 33/60... A1:96 A2:96
  Pair 34/60... A1:96 A2:96
  Pair 35/60... A1:96 A2:96
  Pair 36/60... A1:96 A2:96
  Pair 37/60... A1:96 A2:96
  Pair 38/60... A1:96 A2:96
  Pair 39/60... A1:96 A2:96
  Pair 40/60... A1:96 A2:96
  Pair 41/60... A1:96 A2:96
  Pair 42/60... A1:96 A2:96
  Pair 43/60... A1:96 A2:96
  Pair 44/60... A1:96 A2:96
  Pair 45/60... A1:96 A2:96
  Pair 46/60... A1:96 A2:96
  Pair 47/60... A1:96 A2:96
  Pair 48/60... A1:96 A2:96
  Pair 49/60... A1:96 A2:96
  Pair 50/60... A1:96 A2:96
  Pair 51/60... A1:96 A2:96
  Pair 52/60... A1:96 A2:96
  Pair 53/60... A1:96 A2:96
  Pair 54/60... A1:96 A2:96
  Pair 55/60... A1:96 A2:96
  Pair 56/60... A1:96 A2:96
  Pair 57/60... A1:96 A2:96
  Pair 58/60... A1:96 A2:96
  Pair 59/60... A1:96 A2:96
  Pair 60/60... A1:96 A2:96
Observed q̂ = 96.0 (target was q=96)

Results:
  q̂ = 96.0 (target: 96)
  θ = 0.1963
  τ* (worst-case) = 0.893
  Features passing τ*: 11

------------------------------------------------------------------------------------------
Top 15 Features:
------------------------------------------------------------------------------------------
  METH__MPHOSPH9                           Π̂=1.000
  METH__STRAP                              Π̂=1.000
  METH__GPR108                             Π̂=0.983
  CNV__FLI1                                Π̂=0.975
  METH__RASA2                              Π̂=0.967
  CNV__CBL                                 Π̂=0.967
  CNV__CCDC6                               Π̂=0.958
  CNV__KCNJ5                               Π̂=0.950
  CNV__KTN1                                Π̂=0.942
  MUT__RB1                                 Π̂=0.933
  CNV__NCOA4                               Π̂=0.900
  CNV__KAT6B                               Π̂=0.875
  CNV__LCK                                 Π̂=0.858
  METH__C1orf135                           Π̂=0.858
  METH__PCCA                               Π̂=0.842

------------------------------------------------------------------------------------------
Biomarker Validation:
------------------------------------------------------------------------------------------
✗  MUT__EGFR            NOT FOUND - EGFR mutations (primary target)
✗  CNV__EGFR            NOT FOUND - EGFR amplification
✗  TPM__EGFR            NOT FOUND - EGFR expression
✗  MUT__KRAS            NOT FOUND - KRAS resistance
✗  MUT__BRAF            NOT FOUND - BRAF resistance
✗  TPM__MET             NOT FOUND - MET bypass
✗  CNV__MET             NOT FOUND - MET amplification

Strong (Π̂≥0.5): 0/7
Weak (Π̂≥0.1): 0/7
Total: 0/7 (0.0%)


==========================================================================================
DRUG: Cisplatin (RF-CPSS, paper-conform)
==========================================================================================

Expected biomarkers (8):
  - MUT__TP53: TP53 (apoptosis)
  - MUT__ERCC1: ERCC1 (NER)
  - MUT__ERCC2: ERCC2 (NER helicase)
  - MUT__MSH2: MSH2 (MMR)
  - MUT__MLH1: MLH1 (MMR)
  - MUT__BRCA1: BRCA1 (HR)
  - MUT__BRCA2: BRCA2 (HR)
  - MUT__KRAS: KRAS (resistance)

Data: n=667, d=410, l=20, q=80

Running paper-conform RF-CPSS with B=60 pairs...
Running CPSS with B=60 pairs, target q=80, method=rf
  Pair 1/60... A1:80 A2:80
  Pair 2/60... A1:80 A2:80
  Pair 3/60... A1:80 A2:80
  Pair 4/60... A1:80 A2:80
  Pair 5/60... A1:80 A2:80
  Pair 6/60... A1:80 A2:80
  Pair 7/60... A1:80 A2:80
  Pair 8/60... A1:80 A2:80
  Pair 9/60... A1:80 A2:80
  Pair 10/60... A1:80 A2:80
  Pair 11/60... A1:80 A2:80
  Pair 12/60... A1:80 A2:80
  Pair 13/60... A1:80 A2:80
  Pair 14/60... A1:80 A2:80
  Pair 15/60... A1:80 A2:80
  Pair 16/60... A1:80 A2:80
  Pair 17/60... A1:80 A2:80
  Pair 18/60... A1:80 A2:80
  Pair 19/60... A1:80 A2:80
  Pair 20/60... A1:80 A2:80
  Pair 21/60... A1:80 A2:80
  Pair 22/60... A1:80 A2:80
  Pair 23/60... A1:80 A2:80
  Pair 24/60... A1:80 A2:80
  Pair 25/60... A1:80 A2:80
  Pair 26/60... A1:80 A2:80
  Pair 27/60... A1:80 A2:80
  Pair 28/60... A1:80 A2:80
  Pair 29/60... A1:80 A2:80
  Pair 30/60... A1:80 A2:80
  Pair 31/60... A1:80 A2:80
  Pair 32/60... A1:80 A2:80
  Pair 33/60... A1:80 A2:80
  Pair 34/60... A1:80 A2:80
  Pair 35/60... A1:80 A2:80
  Pair 36/60... A1:80 A2:80
  Pair 37/60... A1:80 A2:80
  Pair 38/60... A1:80 A2:80
  Pair 39/60... A1:80 A2:80
  Pair 40/60... A1:80 A2:80
  Pair 41/60... A1:80 A2:80
  Pair 42/60... A1:80 A2:80
  Pair 43/60... A1:80 A2:80
  Pair 44/60... A1:80 A2:80
  Pair 45/60... A1:80 A2:80
  Pair 46/60... A1:80 A2:80
  Pair 47/60... A1:80 A2:80
  Pair 48/60... A1:80 A2:80
  Pair 49/60... A1:80 A2:80
  Pair 50/60... A1:80 A2:80
  Pair 51/60... A1:80 A2:80
  Pair 52/60... A1:80 A2:80
  Pair 53/60... A1:80 A2:80
  Pair 54/60... A1:80 A2:80
  Pair 55/60... A1:80 A2:80
  Pair 56/60... A1:80 A2:80
  Pair 57/60... A1:80 A2:80
  Pair 58/60... A1:80 A2:80
  Pair 59/60... A1:80 A2:80
  Pair 60/60... A1:80 A2:80
Observed q̂ = 80.0 (target was q=80)

Results:
  q̂ = 80.0 (target: 80)
  θ = 0.1951
  τ* (worst-case) = 0.890
  Features passing τ*: 40

------------------------------------------------------------------------------------------
Top 15 Features:
------------------------------------------------------------------------------------------
  CNV__BMPR1A                              Π̂=1.000
  CNV__NFKB2                               Π̂=1.000
✓ MUT__KRAS                                Π̂=1.000
  CNV__TLX1                                Π̂=1.000
  CNV__KAT6B                               Π̂=1.000
  MUT__ACVR2A                              Π̂=1.000
  CNV__FAS                                 Π̂=1.000
  CNV__SUFU                                Π̂=1.000
  CNV__RAP1GDS1                            Π̂=1.000
  CNV__CYP2C8                              Π̂=1.000
  TPM__IKZF1                               Π̂=1.000
  TPM__TM4SF1-AS1                          Π̂=1.000
  CNV__TET1                                Π̂=1.000
  CNV__PRF1                                Π̂=1.000
  CNV__TCF7L2                              Π̂=1.000

------------------------------------------------------------------------------------------
Biomarker Validation:
------------------------------------------------------------------------------------------
✗  MUT__TP53            NOT FOUND - TP53 (apoptosis)
✗  MUT__ERCC1           NOT FOUND - ERCC1 (NER)
~  MUT__ERCC2           Rank 158, Π̂=0.025 - ERCC2 (NER helicase) (too weak)
✗  MUT__MSH2            NOT FOUND - MSH2 (MMR)
✓✓ MUT__MLH1            Rank  88, Π̂=0.908 - MLH1 (MMR)
✗  MUT__BRCA1           NOT FOUND - BRCA1 (HR)
✓✓ MUT__BRCA2           Rank 402, Π̂=0.967 - BRCA2 (HR)
✓✓ MUT__KRAS            Rank 166, Π̂=1.000 - KRAS (resistance)

Strong (Π̂≥0.5): 3/8
Weak (Π̂≥0.1): 0/8
Total: 3/8 (37.5%)


==========================================================================================
DRUG: Dabrafenib (RF-CPSS, paper-conform)
==========================================================================================

Expected biomarkers (4):
  - MUT__BRAF: BRAF V600E (primary target)
  - MUT__NRAS: NRAS (MAPK pathway)
  - MUT__KRAS: KRAS (MAPK pathway)
  - TPM__BRAF: BRAF expression

Data: n=822, d=489, l=24, q=96

Running paper-conform RF-CPSS with B=60 pairs...
Running CPSS with B=60 pairs, target q=96, method=rf
  Pair 1/60... A1:96 A2:96
  Pair 2/60... A1:96 A2:96
  Pair 3/60... A1:96 A2:96
  Pair 4/60... A1:96 A2:96
  Pair 5/60... A1:96 A2:96
  Pair 6/60... A1:96 A2:96
  Pair 7/60... A1:96 A2:96
  Pair 8/60... A1:96 A2:96
  Pair 9/60... A1:96 A2:96
  Pair 10/60... A1:96 A2:96
  Pair 11/60... A1:96 A2:96
  Pair 12/60... A1:96 A2:96
  Pair 13/60... A1:96 A2:96
  Pair 14/60... A1:96 A2:96
  Pair 15/60... A1:96 A2:96
  Pair 16/60... A1:96 A2:96
  Pair 17/60... A1:96 A2:96
  Pair 18/60... A1:96 A2:96
  Pair 19/60... A1:96 A2:96
  Pair 20/60... A1:96 A2:96
  Pair 21/60... A1:96 A2:96
  Pair 22/60... A1:96 A2:96
  Pair 23/60... A1:96 A2:96
  Pair 24/60... A1:96 A2:96
  Pair 25/60... A1:96 A2:96
  Pair 26/60... A1:96 A2:96
  Pair 27/60... A1:96 A2:96
  Pair 28/60... A1:96 A2:96
  Pair 29/60... A1:96 A2:96
  Pair 30/60... A1:96 A2:96
  Pair 31/60... A1:96 A2:96
  Pair 32/60... A1:96 A2:96
  Pair 33/60... A1:96 A2:96
  Pair 34/60... A1:96 A2:96
  Pair 35/60... A1:96 A2:96
  Pair 36/60... A1:96 A2:96
  Pair 37/60... A1:96 A2:96
  Pair 38/60... A1:96 A2:96
  Pair 39/60... A1:96 A2:96
  Pair 40/60... A1:96 A2:96
  Pair 41/60... A1:96 A2:96
  Pair 42/60... A1:96 A2:96
  Pair 43/60... A1:96 A2:96
  Pair 44/60... A1:96 A2:96
  Pair 45/60... A1:96 A2:96
  Pair 46/60... A1:96 A2:96
  Pair 47/60... A1:96 A2:96
  Pair 48/60... A1:96 A2:96
  Pair 49/60... A1:96 A2:96
  Pair 50/60... A1:96 A2:96
  Pair 51/60... A1:96 A2:96
  Pair 52/60... A1:96 A2:96
  Pair 53/60... A1:96 A2:96
  Pair 54/60... A1:96 A2:96
  Pair 55/60... A1:96 A2:96
  Pair 56/60... A1:96 A2:96
  Pair 57/60... A1:96 A2:96
  Pair 58/60... A1:96 A2:96
  Pair 59/60... A1:96 A2:96
  Pair 60/60... A1:96 A2:96
Observed q̂ = 96.0 (target was q=96)

Results:
  q̂ = 96.0 (target: 96)
  θ = 0.1963
  τ* (worst-case) = 0.893
  Features passing τ*: 44

------------------------------------------------------------------------------------------
Top 15 Features:
------------------------------------------------------------------------------------------
✓ MUT__BRAF                                Π̂=1.000
  METH__RINL                               Π̂=1.000
  METH__EGFL8                              Π̂=1.000
  METH__HNRPLL                             Π̂=1.000
  TPM__MIR142HG                            Π̂=1.000
  METH__EVL                                Π̂=1.000
  METH__PTPRK                              Π̂=1.000
  METH__ARHGEF10                           Π̂=1.000
  METH__TMEM199                            Π̂=1.000
  TPM__IKZF1                               Π̂=1.000
  METH__DENND4B                            Π̂=1.000
  METH__BRD2                               Π̂=1.000
  METH__AP1B1                              Π̂=1.000
  METH__PCDH7                              Π̂=1.000
  METH__BIN2                               Π̂=1.000

------------------------------------------------------------------------------------------
Biomarker Validation:
------------------------------------------------------------------------------------------
✓✓ MUT__BRAF            Rank   1, Π̂=1.000 - BRAF V600E (primary target)
✗  MUT__NRAS            NOT FOUND - NRAS (MAPK pathway)
✓✓ MUT__KRAS            Rank  38, Π̂=0.892 - KRAS (MAPK pathway)
✗  TPM__BRAF            NOT FOUND - BRAF expression

Strong (Π̂≥0.5): 2/4
Weak (Π̂≥0.1): 0/4
Total: 2/4 (50.0%)


==========================================================================================
SUMMARY
==========================================================================================
Erlotinib      : 0/7 biomarkers (0.0%) - Strong: 0, Weak: 0
Cisplatin      : 3/8 biomarkers (37.5%) - Strong: 3, Weak: 0
Dabrafenib     : 2/4 biomarkers (50.0%) - Strong: 2, Weak: 0

OVERALL: 5/19 (26.3%)
~ PARTIAL: 25-50% biomarkers found
